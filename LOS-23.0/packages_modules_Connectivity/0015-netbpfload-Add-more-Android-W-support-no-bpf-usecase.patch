From 96f41a1ddb6906116b867176912c31ac8ba4e22e Mon Sep 17 00:00:00 2001
From: Dominggoes Isakh <drjisakh@gmail.com>
Date: Sun, 30 Nov 2025 13:08:24 +0100
Subject: [PATCH 15/15] netbpfload: Add more Android W support no-bpf usecase

Change-Id: I697dbf88edf64552ce0ce8577b7b8f107340dda4
---
 bpf/loader/NetBpfLoad.cpp | 15 ++++++---------
 1 file changed, 6 insertions(+), 9 deletions(-)

diff --git a/bpf/loader/NetBpfLoad.cpp b/bpf/loader/NetBpfLoad.cpp
index dea5b5e6e4..e4ec77df39 100644
--- a/bpf/loader/NetBpfLoad.cpp
+++ b/bpf/loader/NetBpfLoad.cpp
@@ -1696,28 +1696,24 @@ static int doLoad(char** argv, char * const envp[]) {
 
     // both S and T require kernel 4.9 (and eBpf support)
     if (!isAtLeastKernelVersion(4, 9, 0)) {
-        ALOGE("Android S & T require kernel 4.9.");
-        return 1;
+        ALOGW("IGNORING: Android S & T require kernel 4.9.");
     }
 
     // U bumps the kernel requirement up to 4.14
     if (isAtLeastU && !isAtLeastKernelVersion(4, 14, 0)) {
-        ALOGE("Android U requires kernel 4.14.");
-        return 1;
+        ALOGW("IGNORING: Android U requires kernel 4.14.");
     }
 
     // V bumps the kernel requirement up to 4.19
     // see also: //system/netd/tests/kernel_test.cpp TestKernel419
     if (isAtLeastV && !isAtLeastKernelVersion(4, 19, 0)) {
-        ALOGE("Android V requires kernel 4.19.");
-        return 1;
+        ALOGW("IGNORING: Android V requires kernel 4.19.");
     }
 
     // 25Q2 bumps the kernel requirement up to 5.4
     // see also: //system/netd/tests/kernel_test.cpp TestKernel54
     if (isAtLeast25Q2 && !isAtLeastKernelVersion(5, 4, 0)) {
-        ALOGE("Android 25Q2 requires kernel 5.4.");
-        return 1;
+        ALOGW("IGNORING: Android 25Q2 requires kernel 5.4.");
     }
 
     // Technically already required by U, but only enforce on V+
@@ -1769,7 +1765,7 @@ static int doLoad(char** argv, char * const envp[]) {
 #undef REQUIRE
 
         if (bad) {
-            ALOGE("Unsupported kernel version (%07x).", kernelVersion());
+            ALOGE("IGNORING: Unsupported kernel version (%07x).", kernelVersion());
         }
     }
 
@@ -1899,6 +1895,7 @@ static int doLoad(char** argv, char * const envp[]) {
             ALOGE("If this triggers randomly, you might be hitting some memory allocation "
                   "problems or startup script race.");
             ALOGE("--- DO NOT EXPECT SYSTEM TO BOOT SUCCESSFULLY ---");
+            ALOGE("--- BUT WE BOOT ANYWAY ;) ---");
         }
     }
 
-- 
2.51.0

